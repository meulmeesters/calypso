var calypso;!function(e){var t;!function(e){var t;!function(e){e.DEFAULT_ACCEPT_HEADER="application/vnd.iuclid6.ext+json",e.DEFINITION_ACCEPT_HEADER="application/vnd.iuclid6.ext+json;type=iuclid6.Definition",e.BASE_URL="http://iuclid.ca:3000",e.BASE_URI=e.BASE_URL+"/iuclid6-ext/api/ext/v1",e.BASE_DEFINITIONS_URI=e.BASE_URI+"/definition",e.SUBMISSION_TYPES_URI=e.BASE_DEFINITIONS_URI+"/submissiontypes",e.DOCUMENT_TREE_URI=e.BASE_DEFINITIONS_URI+"/tree",e.SUBSTANCE_URI=e.BASE_URI,e.END_POINT_STUDY_URI=e.BASE_URI+"/endpointstudy"}(t=e.API||(e.API={}))}(t=e.Const||(e.Const={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(e){var t;!function(e){e.addFilter="filter.add",e.afterAddFilter="filter.add.after",e.removeFilter="filter.remove",e.afterRemoveFilter="filter.remove.after",e.applyFilters="filter.apply",e.afterApplyFilters="filter.apply.after",e.loadIuclidEndPointStudies="iuclidEndPointStudy.load",e.loadIuclidSubstances="iuclidSubstance.load",e.performSearch="search.load",e.loadSubmissionType="submission-type.load",e.loadDocument="document.load"}(t=e.Events||(e.Events={}))}(t=e.Const||(e.Const={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(e){var t;!function(e){e.Sort={ASC:"fieldAscending",DESC:"fieldDescending"},e.ORGANIZATION={title:"Organization",type:"checkbox",category:"ORGANIZATION",options:[{category:"ORGANIZATION",key:"OECD",label:"OECD",value:!1,submitValue:"OECD",multi:!1},{category:"ORGANIZATION",key:"HC",label:"Health Canada",value:!1,submitValue:"HC",multi:!1},{category:"ORGANIZATION",key:"EC",label:"Environment Canada and Climate Change",value:!1,submitValue:"EC",multi:!1}]},e.IUCLID_SUBSTANCE_FILTERS=[e.ORGANIZATION]}(t=e.Filters||(e.Filters={}))}(t=e.Const||(e.Const={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(e){var t;!function(e){e.FAVORITE_IUCLID_END_POINT_STUDIES="calypso.iuclidEndPointStudies.favorites",e.FAVORITE_IUCLID_SUBSTANCES="calypso.iuclidSubstances.favorites"}(t=e.LocalStorage||(e.LocalStorage={}))}(t=e.Const||(e.Const={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(e){var t;!function(e){e.DEFAULT_LIMIT=12}(t=e.Paging||(e.Paging={}))}(t=e.Const||(e.Const={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(e){var t;!function(e){var t="/templates/";e.SUBSTANCES_TPL=t+"substances.html",e.NEW_SUBSTANCE_TPL=t+"new-substance.html",e.ENDPOINTSTUDIES_TPL=t+"endpointstudies.html",e.HOME_TPL=t+"home.html",e.NOT_FOUND_TPL=t+"not-found.html",e.GENERIC_FORM_TPL=t+"directives/generic-form.html",e.SEARCH_BAR_TPL=t+"directives/search-bar.html",e.SIDE_FILTER_TPL=t+"directives/side-filter.html",e.SIDE_TREE_TPL=t+"directives/side-tree/side-tree.html",e.SIDE_TREE_SECTION_TPL=t+"directives/side-tree/side-tree-section.html",e.IUCLID_SUBSTANCE_FILTER_TPL=t+"directives/iuclid-substance-filter.html",e.IUCLID_SUBSTANCE_LIST_TPL=t+"directives/iuclid-substance-list.html",e.IUCLID_END_POINT_STUDY_FILTER_TPL=t+"directives/iuclid-end-point-study-filter.html",e.IUCLID_END_POINT_STUDY_LIST_TPL=t+"directives/iuclid-end-point-study-list.html",e.BREADCRUMB_TPL=t+"directives/breadcrumbs.html",e.PAGING_TPL=t+"directives/paging.html",e.IUCLID_FORM_TPL=t+"directives/iuclid-form/iuclid-form.html",e.IUCLID_FORM_TOOLBAR_TPL=t+"directives/iuclid-form/form-toolbar.html",e.IUCLID_FORM_CONTENTS_TPL=t+"directives/iuclid-form/iuclid-form-contents.html",e.IUCLID_FORM_PICKER_TPL=t+"directives/iuclid-form/iuclid-form-picker.html",e.IUCLID_ATTRIBUTE_BLOCK_TPL=t+"directives/iuclid-attributes/iuclid-block.html",e.IUCLID_ATTRIBUTE_CHECKBOX_TPL=t+"directives/iuclid-attributes/iuclid-checkbox.html",e.IUCLID_ATTRIBUTE_TEXT_TPL=t+"directives/iuclid-attributes/iuclid-text.html",e.IUCLID_ATTRIBUTE_PICK_LIST_TPL=t+"directives/iuclid-attributes/iuclid-pick-list.html",e.IUCLID_ATTRIBUTE_ATTACHMENT_TPL=t+"directives/iuclid-attributes/iuclid-attachment.html",e.IUCLID_ATTRIBUTE_RANGE_TPL=t+"directives/iuclid-attributes/iuclid-range.html",e.IUCLID_ATTRIBUTE_NUMERIC_TPL=t+"directives/iuclid-attributes/iuclid-numeric.html",e.IUCLID_ATTRIBUTE_DATE_TPL=t+"directives/iuclid-attributes/iuclid-date.html"}(t=e.Templates||(e.Templates={}))}(t=e.Const||(e.Const={}))}(calypso||(calypso={}));var calypso;!function(e){var t=e.Const.Templates;angular.module("calypso.services",[]),angular.module("calypso.directives",[]),angular.module("calypso",["ngRoute","calypso.services","calypso.directives"]),angular.module("calypso").constant("_",_),angular.module("calypso").config(["$routeProvider","$compileProvider",function(e,i){i.debugInfoEnabled(!1),e.when("/",{templateUrl:t.HOME_TPL}).when("/substances",{templateUrl:t.SUBSTANCES_TPL}).when("/endpointstudies",{templateUrl:t.ENDPOINTSTUDIES_TPL}).when("/substances/new",{templateUrl:t.NEW_SUBSTANCE_TPL}).when("/picklist",{templateUrl:t.IUCLID_ATTRIBUTE_PICK_LIST_TPL}).otherwise({templateUrl:t.NOT_FOUND_TPL})}]),angular.module("calypso").run(["AppConfig",function(e){e.loadSubmissionTypes("SUBSTANCE")}])}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){var i,n=e.Const.API,o=function(){function e(e,t){this.$http=e,this.DB=t,i=this}return e.prototype.loadSubmissionTypes=function(e){i.$http.get(n.SUBMISSION_TYPES_URI,{headers:{Accept:n.DEFINITION_ACCEPT_HEADER},params:{for:e}}).then(function(e){i.DB.setSubmissionTypes(e.data)}).catch(function(e){console.error("Failed to load Submission Types: "+JSON.stringify(e))})},e}();o.$inject=["$http","DB"],t.AppConfig=o,angular.module("calypso.services").service("AppConfig",o)}(t=e.Services||(e.Services={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){var i,n=function(){function t(t,n,o){this.$parse=t,this._=n,this.EventBus=o,i=this,i._db={filters:{},iuclidSubstances:[],submissionTypes:[],sort:{field:"tpmillesime",dir:e.Const.Filters.Sort.DESC},paging:{offset:0,limit:e.Const.Paging.DEFAULT_LIMIT}},o.subscribe(e.Const.Events.addFilter,i,i.addFilter),o.subscribe(e.Const.Events.removeFilter,i,i.removeFilter),o.subscribe(e.Const.Events.loadIuclidSubstances,i,i.loadIuclidSubstances)}return t.prototype.addFilter=function(t){t&&(t.multi?(i._db.filters[t.category]=i._db.filters[t.category]||[],i._db.filters[t.category].push(t)):i._db.filters[t.category]=t,i.EventBus.publish(e.Const.Events.afterAddFilter,t),i.EventBus.publish(e.Const.Events.applyFilters))},t.prototype.removeFilter=function(t){var n=i._db.filters;if(n&&n[t.category]){if(t.multi){var o=n[t.category];o.splice(_.findIndex(o,{key:t.key}),1),0===o.length&&delete n[t.category]}else delete n[t.category];i.EventBus.publish(e.Const.Events.afterRemoveFilter,t),t.skipApply!==!0&&i.EventBus.publish(e.Const.Events.applyFilters)}var c=i._.findIndex(e.Const.Filters.IUCLID_SUBSTANCE_FILTERS,{category:t.category}),r=e.Const.Filters.IUCLID_SUBSTANCE_FILTERS[c];if(r)if(t.multi){if(c=i._.findIndex(r.options,{key:t.key}),r.options[c])switch(r.type){case"checkbox":r.options[c].value=!1}}else switch(r.type){case"checkbox":var s=i._.find(r.options,{key:t.key})||{};s.value=!1}},t.prototype.loadIuclidSubstances=function(e){var t=e.results,n=i.getIuclidSubstances();n.splice(0,n.length),n.push.apply(n,t)},t.prototype.loadIuclidEndPointStudies=function(e){var t=e.results,n=i.getIuclidEndPointStudies();n.splice(0,n.length),n.push.apply(n,t)},t.prototype.getFilters=function(){return i.$parse("_db.filters")(i)},t.prototype.getIuclidEndPointStudies=function(){return i.$parse("_db.iuclidEndPointStudies")(i)},t.prototype.getIuclidSubstances=function(){return i.$parse("_db.iuclidSubstances")(i)},t.prototype.getSorting=function(){return i.$parse("_db.sort")(i)},t.prototype.getPaging=function(){return i.$parse("_db.paging")(i)},t.prototype.setPaging=function(e){i._db.paging=e},t.prototype.setSubmissionTypes=function(e){var t=i.getSubmissionTypes();t.splice(0,t.length),t.push.apply(t,e)},t.prototype.getSubmissionTypes=function(){return i.$parse("_db.submissionTypes")(i)},t}();n.$inject=["$parse","_","EventBus"],t.DB=n,angular.module("calypso.services").service("DB",n)}(t=e.Services||(e.Services={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){var i,n=e.Const.API,o=function(){function e(e,t,n){this.$q=e,this.$http=t,this.$timeout=n,this._cache={},i=this}return e.prototype.getDocumentDefinition=function(e){var t=i.$q.defer(),o=n.BASE_DEFINITIONS_URI+"/document/"+e;return i._cache[e]?i.$timeout(function(){t.resolve(i._cache[e])},50):i.$http.get(o,{params:{_c:(new Date).getTime()},headers:{Accept:n.DEFINITION_ACCEPT_HEADER}}).then(function(n){i._cache[e]=n.data,t.resolve(n.data)}).catch(function(e){alert("Failed to Get Document Definition: "+JSON.stringify(e))}),t.promise},e}();o.$inject=["$q","$http","$timeout"],t.DocumentService=o,angular.module("calypso.services").service("DocumentService",o)}(t=e.Services||(e.Services={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(e){var t,i=function(){function e(){t=this,t._topics={},t._subUid=-1}return e.prototype.subscribe=function(e,i,n,o){t._topics[e]||(t._topics[e]=[]);var c=(++t._subUid).toString();return t._topics[e].push({token:c,handler:n,scope:i,priority:o||1e4}),c},e.prototype.publish=function(e,i){if(!t._topics[e])return!1;var n=t._topics[e],o=n?n.length:0;return o>0&&n.sort(function(e,t){return e.priority-t.priority}).forEach(function(e){angular.isFunction(e.handler)&&e.handler.call(e.scope,i)}),!0},e.prototype.unsubscribe=function(e){for(var i in t._topics)if(t._topics[i])for(var n=0,o=t._topics[i].length;n<o;n++)if(t._topics[i][n].token===e)return t._topics[i].splice(n,1),!0;return!1},e}();e.EventBus=i,angular.module("calypso.services").service("EventBus",i)}(t=e.Services||(e.Services={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){var i,n=e.Const.API,o=function(){function e(e,t){this.$q=e,this.$http=t,this._cache={},i=this}return e.prototype.get=function(e){var t=i.$q.defer(),o=n.BASE_DEFINITIONS_URI+"/phrasegroup/"+e+"/phrases";return i._cache[e]?t.resolve(i._cache[e]):i.$http.get(o).then(function(n){i._cache[e]=n.data,t.resolve(n.data)}).catch(function(e){console.error("Error: "+e)}),t.promise},e}();o.$inject=["$q","$http"],t.IuclidPhraseGroup=o,angular.module("calypso.services").service("IuclidPhraseGroup",o)}(t=e.Services||(e.Services={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){var i,n=function(){function t(t,n,o,c,r){this.$window=t,this.$q=n,this.$http=o,this.EventBus=c,this.ReqBuilder=r,i=this,c.subscribe(e.Const.Events.performSearch,i,i.performSearch)}return t.prototype.search=function(e){var t=i.$q.defer(),n=i.ReqBuilder.getUri(e)+"/raw/SUBSTANCE/8082ace8-26b8-4800-914f-5c44988ebebc";console.log("The Substance uri is "+n);var o=i.ReqBuilder.getData(e);console.log("The Data is "+o);var c={headers:{accept:"application/vnd.iuclid6.ext+json; type=iuclid6.Document","iuclid6-user":"SuperUser","iuclid6-pass":"root"}};return i.$http.get(n,c,o).then(function(e){var n={totalCount:e.data.length,results:e.data};i.enrich(n),t.resolve(n)}).catch(function(e){t.reject(e)}),t.promise},t.prototype.enrich=function(t){var n=e.Const.LocalStorage.FAVORITE_IUCLID_SUBSTANCES,o=i.$window.localStorage.getItem(n),c=o?JSON.parse(o):{};console.log(JSON.stringify(t)),t.results.forEach(function(e){e._favorite=!!c[e.key],console.log(e.name)})},t}();n.$inject=["$window","$q","$http","EventBus","ReqBuilder"],t.IuclidSubstance=n,angular.module("calypso.services").service("IuclidSubstance",n)}(t=e.Services||(e.Services={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){var i,n=function(){function t(t,n,o,c){this.$rootScope=t,this.EventBus=n,this.DB=o,this.IuclidSubstance=c,i=this,n.subscribe(e.Const.Events.applyFilters,i,i.applyFilters),n.subscribe(e.Const.Events.performSearch,i,i.performSearch)}return t.prototype.buildSearchReq=function(){var e=i.DB.getFilters(),t=Object.keys(e).map(function(t){return e[t]});return{filters:t,sort:i.DB.getSorting(),paging:i.DB.getPaging()}},t.prototype.performSearch=function(){i.$rootScope.loading=!0,i.IuclidSubstance.search(i.buildSearchReq()).then(function(t){i.EventBus.publish(e.Const.Events.loadIuclidSubstances,t),i.$rootScope.loading=!1}).catch(function(e){alert("Error searching for Iuclid Substances"),i.$rootScope.loading=!1})},t.prototype.applyFilters=function(){i.performSearch()},t}();n.$inject=["$rootScope","EventBus","DB","IuclidSubstance"],t.IuclidSubstanceFilter=n,angular.module("calypso.services").service("IuclidSubstanceFilter",n)}(t=e.Services||(e.Services={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){var i,n=function(){function t(t){this._=t,this.defaultSearchReqData={aq:"",searchHub:"default",language:"en",pipeline:"default",firstResult:0,numberOfResults:e.Const.Paging.DEFAULT_LIMIT,excerptLength:200,filterField:null,enableDidYouMean:!0,sortCriteria:"fieldDescending",sortField:"@tpmillesime",queryFunctions:[],rankingFunctions:[],retrieveFirstSentences:!0,timezone:"America/New_York",enableDuplicateFiltering:!1,enableCollaborativeRating:!1},i=this}return t.prototype.getUri=function(t){return""+e.Const.API.SUBSTANCE_URI},t.prototype.getData=function(e){var t=angular.extend({},i.defaultSearchReqData,{aq:i.getFilters(e.filters),q:i.getMainSearch(e.filters),sortField:"@"+e.sort.field,sortCriteria:e.sort.dir,firstResult:e.paging.offset,numberOfResults:e.paging.limit});return t},t.prototype.getMainSearch=function(e){return(i._.find(e,{key:"main-search"})||{}).submitValue},t.prototype.getFilters=function(e){var t={};e.forEach(function(e){angular.isArray(e)&&e.length>0?t[e[0].category]=e:t[e.category]=e});var i=Object.keys(t);return i.reduce(function(e,i){if("main-search"!==i){var n=t[i];angular.isArray(n)&&n.length>0?n.length>1?(e+="(@"+i+"==(",n.forEach(function(t,i){e+=t.submitValue,e+=i<n.length-1?",":""}),e+="))"):e+="(@"+i+"=="+n[0].submitValue+")":e+="(@"+i+"=="+n.submitValue+")"}return e},"")},t}();n.$inject=["_"],t.ReqBuilder=n,angular.module("calypso.services").service("ReqBuilder",n)}(t=e.Services||(e.Services={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){var i,n=e.Const.API,o=function(){function e(e,t){this.$q=e,this.$http=t,i=this}return e.prototype._formatTreeDefinition=function(e){var t={code:e.code,title:e.title,completed:{title:"Completed",documents:[]},required:{title:"Required",documents:[]},optional:{title:"Optional",documents:[]}},i=function(e){e&&e.length>0&&e.forEach(function(e){e.documents.forEach(function(e){e.required===!0?t.required.documents.push(e):t.optional.documents.push(e)}),i(e.sections)})};return i(e.sections),t},e.prototype.getTreeDefinition=function(e){var t=i.$q.defer(),o=n.DOCUMENT_TREE_URI+"/"+e;return i.$http.get(o,{headers:{Accept:n.DEFAULT_ACCEPT_HEADER},params:{for:"SUBSTANCE"}}).then(function(e){var n=i._formatTreeDefinition(e.data);t.resolve(n)}).catch(function(e){alert("Failed to Get Tree Definition: "+JSON.stringify(e))}),t.promise},e}();o.$inject=["$q","$http"],t.TreeService=o,angular.module("calypso.services").service("TreeService",o)}(t=e.Services||(e.Services={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){var i=e.Const.Templates;angular.module("calypso.directives").directive("iuclidSubstanceFilter",["_","DB","EventBus",function(t,n,o){return{restrict:"E",scope:{filter:"="},templateUrl:i.IUCLID_SUBSTANCE_FILTER_TPL,link:function(t){t.onChange=function(t,i){switch(i.type){case"checkbox":var n=t.value===!0?e.Const.Events.addFilter:e.Const.Events.removeFilter;t.multi===!1&&i.options.forEach(function(i){i.key!==t.key&&i.value===!0&&(i.skipApply=!0,i.value=!1,o.publish(e.Const.Events.removeFilter,i))}),o.publish(n,t)}}}}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){var i=e.Const.Templates;angular.module("calypso.directives").directive("iuclidEndPointStudyList",["$window","DB","EventBus",function(t,n,o){return{restrict:"E",scope:{},templateUrl:i.IUCLID_END_POINT_STUDY_LIST_TPL,link:function(i,c){i.iuclidEndPointStudies=n.getIuclidEndPointStudies(),i.openIuclidEndPointStudy=function(e){e&&e.clickUri&&t.open(e.clickUri)},i.favoriteIuclidEndPointStudy=function(i,n){n.preventDefault(),n.stopPropagation();var o=e.Const.LocalStorage.FAVORITE_IUCLID_END_POINT_STUDIES,c=t.localStorage.getItem(o),r=c?JSON.parse(c):{};i._favorite===!0?(i._favorite=!1,delete r[i.key]):(i._favorite=!0,r[i.key]=!0),t.localStorage.setItem(o,JSON.stringify(r))},o.subscribe(e.Const.Events.loadIuclidEndPointStudies,i,function(){document.querySelector("div.iuclid-end-point-study-list").scrollTop=0})}}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){var i=e.Const.Templates;angular.module("calypso.directives").directive("iuclidSubstanceList",["$window","DB","EventBus",function(t,n,o){return{restrict:"E",scope:{},templateUrl:i.IUCLID_SUBSTANCE_LIST_TPL,link:function(i,c){i.iuclidSubstances=n.getIuclidSubstances(),i.openIuclidSubstance=function(e){e&&e.clickUri&&t.open(e.clickUri)},i.favoriteIuclidSubstance=function(i,n){n.preventDefault(),n.stopPropagation();var o=e.Const.LocalStorage.FAVORITE_IUCLID_SUBSTANCES,c=t.localStorage.getItem(o),r=c?JSON.parse(c):{};i._favorite===!0?(i._favorite=!1,delete r[i.key]):(i._favorite=!0,r[i.key]=!0),t.localStorage.setItem(o,JSON.stringify(r))},o.subscribe(e.Const.Events.loadIuclidSubstances,i,function(){document.querySelector("div.iuclid-substance-list").scrollTop=0})}}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){var i=e.Const.Templates;angular.module("calypso.directives").directive("searchBar",["EventBus","IuclidSubstanceFilter",function(t,n){return{restrict:"E",scope:{},templateUrl:i.SEARCH_BAR_TPL,link:function(i,n){var o=n.find("input");o.bind("keydown",function(i){if(13===i.which){var n=o.val();t.publish(e.Const.Events.addFilter,{category:"main-search",key:"main-search",label:"",bcDisplay:n,multi:!1,value:n,submitValue:n}),o.val("")}})}}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){var i=e.Const.Templates;angular.module("calypso.directives").directive("sideFilter",[function(){return{restrict:"E",scope:{filters:"="},templateUrl:i.SIDE_FILTER_TPL,link:function(t){console.log("FILTERS:"+t.filters),t.filters=e.Const.Filters.IUCLID_SUBSTANCE_FILTERS}}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){angular.module("calypso.directives").directive("iuclidAttachment",[function(){return{scope:{content:"="},templateUrl:e.Const.Templates.IUCLID_ATTRIBUTE_ATTACHMENT_TPL}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){angular.module("calypso.directives").directive("iuclidBlock",[function(){return{scope:{content:"="},templateUrl:e.Const.Templates.IUCLID_ATTRIBUTE_BLOCK_TPL,link:function(e){e.state={collapsed:!0},e.toggleWrapper=function(){e.state.collapsed=!e.state.collapsed}}}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){angular.module("calypso.directives").directive("iuclidCheckbox",[function(){return{scope:{content:"="},templateUrl:e.Const.Templates.IUCLID_ATTRIBUTE_CHECKBOX_TPL}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){angular.module("calypso.directives").directive("iuclidDate",[function(){return{scope:{content:"="},templateUrl:e.Const.Templates.IUCLID_ATTRIBUTE_DATE_TPL}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){angular.module("calypso.directives").directive("iuclidNumeric",[function(){return{scope:{content:"="},templateUrl:e.Const.Templates.IUCLID_ATTRIBUTE_NUMERIC_TPL}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){angular.module("calypso.directives").directive("iuclidPickList",["IuclidPhraseGroup",function(t){return{scope:{content:"="},templateUrl:e.Const.Templates.IUCLID_ATTRIBUTE_PICK_LIST_TPL,link:function(e){e.state={phraseGroup:[]},t.get(e.content.phrasegroup).then(function(t){e.state.phraseGroup=t}).catch(function(e){console.error("Error Getting Phrase Group: "+JSON.stringify(e))})}}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){angular.module("calypso.directives").directive("iuclidRange",[function(){return{scope:{content:"="},templateUrl:e.Const.Templates.IUCLID_ATTRIBUTE_RANGE_TPL}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){angular.module("calypso.directives").directive("iuclidText",[function(){return{scope:{content:"="},templateUrl:e.Const.Templates.IUCLID_ATTRIBUTE_TEXT_TPL}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){angular.module("calypso.directives").directive("formToolbar",[function(){return{templateUrl:e.Const.Templates.IUCLID_FORM_TOOLBAR_TPL}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){angular.module("calypso.directives").directive("iuclidForm",[function(){return{scope:{document:"="},templateUrl:e.Const.Templates.IUCLID_FORM_TPL}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){angular.module("calypso.directives").directive("iuclidFormContent",[function(){return{scope:{contents:"="},templateUrl:e.Const.Templates.IUCLID_FORM_CONTENTS_TPL}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){var i=e.Const.Events;angular.module("calypso.directives").directive("iuclidFormPicker",["$rootScope","$timeout","EventBus","DB","DocumentService",function(t,n,o,c,r){return{scope:{},templateUrl:e.Const.Templates.IUCLID_FORM_PICKER_TPL,link:function(e,n){var s;e.state={document:null,submissionType:null,submissionTypes:c.getSubmissionTypes()},e.loadSubmissionType=function(){e.state.document=null,s=null,o.publish(i.loadSubmissionType,e.state.submissionType)},o.subscribe(i.loadDocument,e,function(i){s!==i&&(t.loading=!0,r.getDocumentDefinition(i).then(function(t){var o=n[0].querySelector(".iuclid-form-content-wrapper");o&&(o.scrollTop=0),e.state.document=t,s=i}).catch(function(e){alert("Failed to Get Document Definition: "+JSON.stringify(e))}).finally(function(){t.loading=!1}))})}}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(e){angular.module("calypso.directives").directive("ngxMultiple",[function(){return{restrict:"A",link:function(e,t,i){"true"!==i.ngxMultiple&&i.ngxMultiple!==!0||t.attr("multiple",!0)}}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){var i=e.Const.Events,n=e.Const.Templates;angular.module("calypso.directives").directive("sideTree",["$rootScope","EventBus","TreeService",function(e,t,o){return{restrict:"E",scope:{},templateUrl:n.SIDE_TREE_TPL,link:function(n){n.state={tree:null},n.props={selectedCode:null},t.subscribe(i.loadSubmissionType,n,function(t){e.loading=!0,n.props.selectedCode=null,o.getTreeDefinition(t.identifier).then(function(e){n.state.tree=e}).catch(function(e){alert("Failed to Load Tree: "+JSON.stringify(e))}).finally(function(){e.loading=!1})}),t.subscribe(i.loadDocument,n,function(e){n.props.selectedCode=e})}}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));var calypso;!function(e){var t;!function(t){var i=e.Const.Events,n=e.Const.Templates;angular.module("calypso.directives").directive("sideTreeSection",["EventBus",function(e){return{restrict:"E",scope:{section:"=",props:"="},templateUrl:n.SIDE_TREE_SECTION_TPL,link:function(t){t.state={collapsed:!0},t.loadNodeDocument=function(t){e.publish(i.loadDocument,t.code)},t.toggleSection=function(e){t.state.collapsed=!t.state.collapsed}}}}])}(t=e.Directives||(e.Directives={}))}(calypso||(calypso={}));